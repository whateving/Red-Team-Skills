# Atlassian Confluence â€” CVE-2022-26134


On May the 30th, 2022, an organisation named Volexity identified an un-authenticated RCE vulnerability (scoring 9.8 on NIST) within Atlassian's Confluence Server and Data Center editions.

Confluence is a collaborative documentation and project management framework for teams. Confluence helps track project status by offering a centralised workspace for members.

The following versions of Confluence are vulnerable to this CVE:

1.3.0 -> 7.4.17  
7.13.0 -> 7.13.7  
7.14.0 -> 7.14.3  
7.15.0 -> 7.15.2  
7.16.0 -> 7.16.4  
7.17.0 -> 7.17.4  
7.18.0 -> 7.18.1  


## Explanation:

This Common Vulnerabilities and Exposures (CVE) exploits a weakness within OGNL (Object-Graph Navigation Language), a standard expression language used in Java applications.

OGNL is typically employed for accessing and modifying properties of Java objects, such as binding user input from a web form (like a text box) directly to corresponding backend objects. The vulnerability arises because the application fails to properly secure or validate the data being processed by OGNL. This lapse allows an attacker to manipulate the input, effectively transforming benign data into a malicious payload capable of executing arbitrary commands within the vulnerable application (e.g., Confluence).

<img width="392" height="642" alt="image" src="https://github.com/user-attachments/assets/65aca62d-5252-4e31-9a23-2e40415ded34" />


Thanks to Journaldev.com for this example of OGNL in use.


## Exploitation:

Download the following PoC:

<img width="624" height="553" alt="image" src="https://github.com/user-attachments/assets/c0680d55-489b-413a-834f-12058f5f5b14" />


Payload is the main part of this PoC.

Run the PoC

<img width="624" height="215" alt="image" src="https://github.com/user-attachments/assets/4e5aac20-d365-422a-bfa7-c62e954fb742" />


As we can see the app is running under the confluence user.

<img width="624" height="215" alt="image" src="https://github.com/user-attachments/assets/763b1bd2-5e83-4514-ac6f-ac8e74d41b9c" />


And as you can see right here, we were even able to get our hands on the flag.txt


## Detection:

The following YARA rule has been created to detect this vulnerability.

https://github.com/volexity/threat-intel/blob/main/2022/2022-06-02%20Active%20Exploitation%20Of%20Confluence%200-day/indicators/yara.yar


## END OF THE REPORT
